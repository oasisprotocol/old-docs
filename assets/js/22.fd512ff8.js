(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{222:function(e,t,s){"use strict";s.r(t);var n=s(0),a=Object(n.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"joining-the-testnet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#joining-the-testnet"}},[e._v("#")]),e._v(" Joining the Testnet")]),e._v(" "),s("p",[e._v("This guide will cover setting up your nodes on the Public Testnet. There is some\nassumption of knowledge on the use of basic command line tools.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If you joined the Testnet prior to 11/26, use the following steps to upgrade:")]),e._v(" "),s("ol",[s("li",[s("router-link",{attrs:{to:"/operators/maintenance/wiping-node-state.html"}},[e._v("Stop your node and wipe state (keep node identity)")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/operators/current-testnet-parameters.html"}},[e._v("Download the current genesis file and "),s("code",[e._v("oasis-node")]),e._v(" to your\nserver")])],1),e._v(" "),s("li",[e._v("See the "),s("router-link",{attrs:{to:"/operators/current-testnet-parameters.html#2019-11-26-latest"}},[e._v("Deployment Change\nLog")]),e._v(" for a list of\nchanges. "),s("em",[e._v("Please ensure that you update your node configuration.")])],1),e._v(" "),s("li",[e._v("Start your node (you may need to "),s("a",{attrs:{href:"#check-that-your-node-is-synced"}},[e._v("wait for your node to\nsync")]),e._v(")")])])]),e._v(" "),s("h2",{attrs:{id:"prerequisites"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),s("p",[e._v("Before following this guide, make sure you've followed the "),s("router-link",{attrs:{to:"/operators/prerequisites.html"}},[e._v("Prerequisites\nGuide")]),e._v(" and understand how to use the "),s("code",[e._v("oasis-node")]),e._v(" binary.")],1),e._v(" "),s("h3",{attrs:{id:"systems"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#systems"}},[e._v("#")]),e._v(" Systems")]),e._v(" "),s("p",[e._v("This guide assumes that you have two different physical machines that you will\nuse for deployment. These machines are the following:")]),e._v(" "),s("ul",[s("li",[e._v("Your local system, henceforth called the "),s("code",[e._v("localhost")]),e._v(".")]),e._v(" "),s("li",[e._v("A remote system to run as an Oasis node, henceforth called the "),s("code",[e._v("server")]),e._v(".")])]),e._v(" "),s("p",[e._v("The reason for this is to ensure protection of the keys used to\nsetup your node. This guide does not include the use of HSMs, but\nshould be used in the future.")]),e._v(" "),s("h2",{attrs:{id:"creating-your-entity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-your-entity"}},[e._v("#")]),e._v(" Creating Your Entity")]),e._v(" "),s("p",[e._v("Everything in this section should be done on the "),s("code",[e._v("localhost")]),e._v(" as there are\nsensitive items that will be created.")]),e._v(" "),s("h3",{attrs:{id:"creating-a-working-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-working-directory"}},[e._v("#")]),e._v(" Creating a Working Directory")]),e._v(" "),s("p",[e._v("During this entity initialization process, we will create keys and other\nimportant artifacts that are necessary for the deployment of nodes on the\nnetwork. It is important that you save and protect the generated artifacts in\nthis directory if you intend to use them to register your entity and nodes. We\nwill reference the working directory on "),s("code",[e._v("localhost")]),e._v(" as "),s("code",[e._v("/localhostdir")]),e._v("\nthroughout the documentation. Inside "),s("code",[e._v("/localhostdir")]),e._v(" you should create the\nfollowing directories:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("entity")]),e._v(" - This will store your entity. The private contents in this directory\nare safest if used on a machine kept disconnected from the internet. The\ndirectory permissions should be "),s("code",[e._v("rwx------")])]),e._v(" "),s("li",[s("code",[e._v("node")]),e._v(' - This will store a node we are calling "node". The name is not\nimportant. It simply represents one of your nodes. You can rename it to\nwhatever you wish. The private contents of this directory will be used on the\nnode itself.\nYou should initialize this information on a system with access to the entity\'s\nprivate key. The directory permissions should be '),s("code",[e._v("rwx------")])])]),e._v(" "),s("p",[e._v("To create the directory structure, use the following command:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -m700 -p "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("entity,node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h3",{attrs:{id:"copying-the-genesis-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copying-the-genesis-file"}},[e._v("#")]),e._v(" Copying the Genesis File")]),e._v(" "),s("p",[e._v("The latest genesis file can be found "),s("router-link",{attrs:{to:"/operators/current-testnet-parameters.html"}},[e._v("here")]),e._v(".\nYou should download the latest "),s("code",[e._v("genesis.json")]),e._v(" file, copy it to the working\ndirectory and save its path into an environment variable:")],1),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GENESIS_FILE_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/localhostdir/genesis.json\n")])])]),s("p",[e._v("This will be needed later when generating transactions.")]),e._v(" "),s("h3",{attrs:{id:"initializing-an-entity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initializing-an-entity"}},[e._v("#")]),e._v(" Initializing an Entity")]),e._v(" "),s("p",[e._v("The entity, as "),s("router-link",{attrs:{to:"/operators/architectural-overview.html#entities-and-key-management"}},[e._v("described\nhere")]),e._v(" is critical to\noperating nodes on the network as it controls the stake attached to a given\nindividual or organization on the network. In the future we will support using\nentity keys through HSMs to ensure that entity keys cannot be easily\ncompromised. We strongly suggest that you do not use any entity that is generated\nwith the current process on the Mainnet. During the Public Testnet and staking\ncompetition we would also suggest that you generate the entity on a system that has\nno network connection to provide rudimentary protection for the entity key.\nHowever, it is up to you to determine your own security practices.")],1),e._v(" "),s("p",[e._v("To initialize an entity simply run the following from "),s("code",[e._v("/localhostdir/entity")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node registry entity init\n")])])]),s("p",[e._v("This will generate 3 files in "),s("code",[e._v("/localhostdir/entity")])]),e._v(" "),s("ul",[s("li",[s("code",[e._v("entity.pem")]),e._v(" - The private key of the entity. "),s("strong",[e._v("NEVER SHARE THIS AS IT CAN BE\nUSED TO TRANSFER STAKE")])]),e._v(" "),s("li",[s("code",[e._v("entity.json")]),e._v(" - The entity descriptor. This is the JSON of the unsigned\ninformation to be sent to the registry application on the network.")]),e._v(" "),s("li",[s("code",[e._v("entity_genesis.json")]),e._v("- This JSON object contains the entity descriptor that\nhas been signed with the the "),s("code",[e._v("entity.pem")]),e._v(". This is meant to be shared for\ninclusion on the genesis block.")])]),e._v(" "),s("h3",{attrs:{id:"initializing-a-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initializing-a-node"}},[e._v("#")]),e._v(" Initializing a Node")]),e._v(" "),s("p",[e._v("A node registers itself to the network when the node starts up. However, in\norder to validate itself, the entity signs a public key associated to the node.\nThis allows the node registration to happen without the uploading entity key to\nthe internet. To initialize a validator node, take note of the static IP of the\nserver where your node will run, and issue the following commands from the\n"),s("code",[e._v("/localhostdir/node")]),e._v(" directory.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("STATIC_IP")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("YOUR_STATIC_IP"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\noasis-node registry node init "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --entity /localhostdir/entity "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --node.consensus_address "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$STATIC_IP")]),e._v(":26656 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --node.is_self_signed "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --node.role validator\n")])])]),s("p",[e._v("This command will create a validator node's identity so that it can be a\nself-signed node (this is what allows self registration). There are more options\nfor this that you can explore by running "),s("code",[e._v("oasis-node registry node init --help")]),e._v(".\nThe options shown above are the minimum.")]),e._v(" "),s("p",[e._v("The command will generate the following files:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("consensus.pem")]),e._v(" - The node's private key used for consensus. "),s("strong",[e._v("DO NOT SHARE")])]),e._v(" "),s("li",[s("code",[e._v("consensus_pub.pem")]),e._v(" - The node's public key for consensus")]),e._v(" "),s("li",[s("code",[e._v("identity.pem")]),e._v(" - The node's identity private key. "),s("strong",[e._v("DO NOT SHARE")])]),e._v(" "),s("li",[s("code",[e._v("identity_pub.pem")]),e._v(" - The node's identity public key.")]),e._v(" "),s("li",[s("code",[e._v("node_genesis.json")]),e._v(" - The node's details if you wish to include this node on\nthe genesis file of the network.")]),e._v(" "),s("li",[s("code",[e._v("p2p.pem")]),e._v(" - The node's private key for libp2p. "),s("strong",[e._v("DO NOT SHARE")])]),e._v(" "),s("li",[s("code",[e._v("p2p_pub.pem")]),e._v(" - The node's public key for libp2p.")]),e._v(" "),s("li",[s("code",[e._v("tls_identity.pem")]),e._v(" - The node's TLS key for grpc's TLS . "),s("strong",[e._v("DO NOT SHARE")])]),e._v(" "),s("li",[s("code",[e._v("tls_identity_cert.pem")]),e._v(" - The node's TLS cert for grpc's TLS.")])]),e._v(" "),s("h4",{attrs:{id:"adding-the-node-to-the-entity-descriptor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-the-node-to-the-entity-descriptor"}},[e._v("#")]),e._v(" Adding the Node to the Entity Descriptor")]),e._v(" "),s("p",[e._v("Once the node has been initialized, we need to add it to the entity descriptor\nso that it can properly register itself when the node starts up.")]),e._v(" "),s("p",[e._v("Execute the following command in the "),s("code",[e._v("/localhostdir/node")]),e._v(" directory:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node registry entity update "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --datadir /localhostdir/entity "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --entity.node.descriptor node_genesis.json\n")])])]),s("p",[e._v("This will update the entity descriptor "),s("code",[e._v("entity.json")]),e._v(" and subsequently the\n"),s("code",[e._v("entity_genesis.json")]),e._v(" file that contains the signed entity descriptor payload.")]),e._v(" "),s("h4",{attrs:{id:"initializing-additional-nodes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initializing-additional-nodes"}},[e._v("#")]),e._v(" Initializing Additional Nodes")]),e._v(" "),s("p",[e._v("At the time of Public Testnet, the network will only have validators and no\nother committees (no compute, no key management, no storage, etc.). At this time\nthis documentation does not include instructions in configuring anything beyond\na single validator. If you'd like to create more validator nodes you can simply\nrepeat the process above to initialize the artifacts for an additional node (and\nrenaming the proper things). Each node will require at least the network's\ndefined minimum staking amount (at this time this is 100 tokens).")]),e._v(" "),s("h2",{attrs:{id:"running-an-oasis-node-on-the-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-oasis-node-on-the-server"}},[e._v("#")]),e._v(" Running an Oasis Node on the "),s("code",[e._v("server")])]),e._v(" "),s("h3",{attrs:{id:"setting-up-the-oasis-node-s-working-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-oasis-node-s-working-directory"}},[e._v("#")]),e._v(" Setting up the Oasis Node's Working Directory")]),e._v(" "),s("p",[e._v("Before we run the node on the "),s("code",[e._v("server")]),e._v(" we need to ensure that we have a place to\nstore necessary files for the node. For this guide, we will call this working\ndirectory "),s("code",[e._v("/serverdir")]),e._v(" directory.")]),e._v(" "),s("h4",{attrs:{id:"setting-up-the-the-serverdir-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-the-serverdir-directory"}},[e._v("#")]),e._v(" Setting up the the "),s("code",[e._v("/serverdir")]),e._v(" Directory")]),e._v(" "),s("p",[e._v("In the "),s("code",[e._v("/serverdir")]),e._v(" directory we will create the following subdirectories:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("etc/")]),e._v(" - this is to store the configuration")]),e._v(" "),s("li",[s("code",[e._v("node/")]),e._v(" - this is to store the node's data")]),e._v(" "),s("li",[s("code",[e._v("node/entity/")]),e._v(" - this is to store the public components of the node's entity")])]),e._v(" "),s("p",[e._v("You can make this directory structure by calling the following command:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -m700 -p /serverdir/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("etc,node,node/entity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h4",{attrs:{id:"copying-the-node-artifacts-from-localhostdir"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copying-the-node-artifacts-from-localhostdir"}},[e._v("#")]),e._v(" Copying the Node Artifacts from "),s("code",[e._v("/localhostdir")])]),e._v(" "),s("p",[e._v("In order for the node registration to work properly, as defined in\n"),s("code",[e._v("/localhostdir/entity.json")]),e._v(", you must copy the node's artifacts you generated in\nthe "),s("a",{attrs:{href:"#initializing-a-node"}},[e._v("Initializing a Node")]),e._v(" section. To do so upload the\nfollowing files from "),s("code",[e._v("/localhostdir/node")]),e._v(" to "),s("code",[e._v("/serverdir/node")]),e._v(" over a secure channel:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("consensus.pem")])]),e._v(" "),s("li",[s("code",[e._v("consensus_pub.pem")])]),e._v(" "),s("li",[s("code",[e._v("identity.pem")])]),e._v(" "),s("li",[s("code",[e._v("identity_pub.pem")])]),e._v(" "),s("li",[s("code",[e._v("p2p.pem")])]),e._v(" "),s("li",[s("code",[e._v("p2p_pub.pem")])]),e._v(" "),s("li",[s("code",[e._v("tls_identity.pem")])]),e._v(" "),s("li",[s("code",[e._v("tls_identity_cert.pem")])])]),e._v(" "),s("p",[e._v("After copying, make sure that all of these files have "),s("code",[e._v("0600")]),e._v(" permissions:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" -R "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("600")]),e._v(" /serverdir/node/*.pem\n")])])]),s("p",[e._v("_You may notice that some of these files were listed as "),s("strong",[e._v("DO NOT SHARE")]),e._v(". In the\nfuture these keys should be generated and referenced from HSM. Before we have\nHSM support, these keys should be kept as secure as possible on the "),s("code",[e._v("server")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"copying-the-public-entity-artifacts-from-localhostdir"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copying-the-public-entity-artifacts-from-localhostdir"}},[e._v("#")]),e._v(" Copying the Public Entity Artifacts from "),s("code",[e._v("/localhostdir")])]),e._v(" "),s("p",[e._v("We will also need to have public entity artifacts from the "),s("code",[e._v("/localhostdir")]),e._v(". Copy\nthe file from "),s("code",[e._v("/localhostdir/entity/entity.json")]),e._v(" to\n"),s("code",[e._v("/serverdir/node/entity/entity.json")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"copying-the-genesis-files"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copying-the-genesis-files"}},[e._v("#")]),e._v(" Copying the Genesis Files")]),e._v(" "),s("p",[e._v("The latest genesis files can be found "),s("router-link",{attrs:{to:"/operators/current-testnet-parameters.html"}},[e._v("here")]),e._v(".\nYou should download the latest "),s("code",[e._v("genesis.json")]),e._v(" file and copy it to\n"),s("code",[e._v("/serverdir/etc/genesis.json")]),e._v(".")],1),e._v(" "),s("h4",{attrs:{id:"configuring-the-oasis-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-the-oasis-node"}},[e._v("#")]),e._v(" Configuring the Oasis Node")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If you deployed a node on the 2019-11-13 Public Testnet, the configuration has\nchanged. Please update your configuration or your node will fail to connect.")])]),e._v(" "),s("p",[e._v("There are a variety of options available when running an Oasis node. The\nfollowing YAML file is a basic configuration for a validator node on the\nnetwork.")]),e._v(" "),s("p",[e._v("Before using this configuration you should collect the following information to\nreplace the "),s("code",{pre:!0},[e._v("{{ var_name }}")]),e._v(" variables present in the\nconfiguration file:")]),e._v(" "),s("ul",[s("li",[s("code",{pre:!0},[e._v("{{ external_address }}")]),e._v(": This is the external IP you wish to\nuse when registering this node. If you are using a Sentry Node, you should use\nthe public IP of that machine.")]),e._v(" "),s("li",[s("code",{pre:!0},[e._v("{{ seed_node_address }}")]),e._v(":  This the seed node address in the\nform "),s("code",[e._v("ID@IP:port")]),e._v(" this is published "),s("router-link",{attrs:{to:"/operators/current-testnet-parameters.html"}},[e._v("here")])],1)]),e._v(" "),s("p",[e._v("Create a file, "),s("code",[e._v("/serverdir/etc/config.yml")]),e._v(", with the following\ncontents:")]),e._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("##")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Oasis Node Configuration")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# This file's configurations are derived from the command line args found in the")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# root command of the oasis-node binary. For more information execute:")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#     oasis-node --help")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Settings on the command line that are separated by a dot all belong to the")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# same nested object. So "--foo.bar.baz hello" would translate to:')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#     foo:")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#       bar:")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#         baz: hello")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("##")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Set this to where you wish to store node data. The node artifacts")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# should also be located in this directory (for us this is /serverdir/node)")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("datadir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" /serverdir/node\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Logging.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Per-module log levels are defined below. If you prefer just one unified log")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# level, you can use:")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# log:")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   level: debug")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Per-module log levels. Longest prefix match will be taken. Fallback to")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# "default", if no match.')]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" debug\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("tendermint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" warn\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("tendermint/context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" error\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" JSON\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# By default logs are output to stdout. If you're running this in docker keep the")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# default")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#file: /var/log/oasis-node.log")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Path to the genesis file for the current version of the network.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("genesis")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" /serverdir/etc/genesis.json\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Worker configuration.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("worker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("registration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# In order for the node to register itself the entity.json of the entity")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# used to provision the node must be available on the node.")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" /serverdir/node/entity/entity.json\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Consensus backend.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("consensus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Setting this to true will mean that the node you're deploying will attempt")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# to register as a validator.")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("validator")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("True")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Tendermint backend configuration.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("tendermint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("abci")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("prune")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("strategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" keep_n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("num_kept")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("86400")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("core")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("listen_address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" tcp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("//0.0.0.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("26656")]),e._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# The external_address option is used when registering this node to the")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# network. If using the Sentry node setup this should be skipped.")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("external_address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" tcp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("//"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" external_address "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("26656")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("db")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("backend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" boltdb\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("addr_book_lenient")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("False")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# You can add additional seeds to this list of seed addresses if you know of")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# additional seeds")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("seed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{{ seed_node_address }}"')]),e._v("\n")])])]),s("h4",{attrs:{id:"ensuring-proper-permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ensuring-proper-permissions"}},[e._v("#")]),e._v(" Ensuring Proper Permissions")]),e._v(" "),s("p",[e._v("Only the owner of the process that runs node should have access to the files in\nthe directory. The "),s("code",[e._v("oasis-node")]),e._v(" binary ensures that the files used by the node\nare as least privileged as possible so that you don't accidentally shoot\nyourself in the foot while operating a node. To ensure the proper permissions,\nwe suggest running the following to remove all non-owner read/write/execute\npermissions:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" -R go-r,go-w,go-x /serverdir\n")])])]),s("p",[e._v("However just so it's clear, the following permissions are expected by the\n"),s("code",[e._v("oasis-node")]),e._v(" command:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("700")]),e._v(" for the "),s("code",[e._v("/serverdir/node")]),e._v(" directory")]),e._v(" "),s("li",[s("code",[e._v("700")]),e._v(" for the "),s("code",[e._v("/serverdir/node/entity")]),e._v(" directory")]),e._v(" "),s("li",[s("code",[e._v("600")]),e._v(" for all "),s("code",[e._v("*.pem")]),e._v(" files")])]),e._v(" "),s("h3",{attrs:{id:"starting-the-oasis-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#starting-the-oasis-node"}},[e._v("#")]),e._v(" Starting the Oasis Node")]),e._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("In a previous version of docs, we asked you to open port "),s("code",[e._v("42261")]),e._v(" on a running\ndocker container. In some configurations we noticed that this port was being\nexposed to the outside world. This is no longer needed and should be removed\nimmediately. Keeping that port open was a temporary measure and is unsafe\ngenerally. Please close that port to the public and do not bind to it in any\nway.")])]),e._v(" "),s("p",[e._v("You can start the server by running the command below. Please note, the node is\nconfigured to run in the foreground. We suggest you daemonize this with a\nprocess supervisor like "),s("a",{attrs:{href:"http://supervisord.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("supervisord"),s("OutboundLink")],1),e._v(",\n"),s("a",{attrs:{href:"https://github.com/systemd/systemd",target:"_blank",rel:"noopener noreferrer"}},[e._v("systemd"),s("OutboundLink")],1),e._v(", etc.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node --config /serverdir/etc/config.yml\n")])])]),s("h3",{attrs:{id:"verifying-the-connection-to-the-network"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#verifying-the-connection-to-the-network"}},[e._v("#")]),e._v(" Verifying the Connection to the Network")]),e._v(" "),s("p",[e._v("As part of the starting the server process, the "),s("code",[e._v("oasis-node")]),e._v(" binary will, by\ndefault, setup an internal unix socket in the "),s("code",[e._v("datadir")]),e._v(" of the Node. This socket\ncan be used to communicate to the node and query details about the network.")]),e._v(" "),s("p",[e._v("Run the following command:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node registry entity list -a unix:/serverdir/node/internal.sock\n")])])]),s("p",[e._v("If this command fails, you'll receive a non-zero exit code and there's a high\nlikelihood that you are not connected to the network. However, if it does work\nproperly it should respond with output like the following but with potentially\nmany more values:")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("2317a8eef10e470434411aebac8f1a8c0f1c6a0d35ff53921f8bc70588bb66b2\n8e3873f84f7f2250eb456dc598dc56b812f561137fe41c383128e6c14e0e2e74\ncf3b004bd98f3e1eab92e97c5fa6cbe4d42a00133c515a2440fefaca514a48ff\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n")])])]),s("p",[e._v("Once you get to a node that's connected you can move on to the next section as\nyour node is not yet registered as a validator on the Oasis Testnet.")]),e._v(" "),s("h2",{attrs:{id:"signing-up-for-testnet-tokens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#signing-up-for-testnet-tokens"}},[e._v("#")]),e._v(" Signing up for Testnet Tokens")]),e._v(" "),s("p",[s("em",[e._v("This won't be necessary if you are in the genesis file or already have tokens\nthrough some other means. For most people, this will not be true.")])]),e._v(" "),s("p",[e._v("In order to participate on the Testnet you'll need to have tokens. You'll use\nthese tokens to register your entity and stake on the network. To get tokens,\nyou'll need to sign up with "),s("a",{attrs:{href:"https://oasisfoundation.typeform.com/to/dlcekq",target:"_blank",rel:"noopener noreferrer"}},[e._v("this\nform"),s("OutboundLink")],1),e._v(". While filling out the\nform, it will ask for your Entity Public Key. This is the same as your Entity\nAccount ID and can be found in the "),s("code",[e._v("/localhostdir/entity/entity.json")]),e._v(". In this\nJSON file, the Entity Public Key is the "),s("code",[e._v("id")]),e._v(" field.")]),e._v(" "),s("h3",{attrs:{id:"example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[e._v("#")]),e._v(" Example")]),e._v(" "),s("p",[e._v("In the following example "),s("code",[e._v("entity.json")]),e._v(", the Entity Public Key is\n"),s("code",[e._v("TszGIrC1X08czcik0DgAnmGPzjf8pfQ47bgrjpTmbro=")]),e._v(".")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"TszGIrC1X08czcik0DgAnmGPzjf8pfQ47bgrjpTmbro="')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"nodes"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"C93lKVNNkca3Oo9m1exiz22NvMBxxYjkyBrt2+eFAds="')]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"registration_time"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1573585972")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"allow_entity_signed_nodes"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("After filling out this form, wait for an email notifying you that you've been\nfunded before moving forward. The following sections assume that you have\nalready been funded.")]),e._v(" "),s("h2",{attrs:{id:"staking-and-registering"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#staking-and-registering"}},[e._v("#")]),e._v(" Staking and Registering")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("This won't be necessary if your Entity is in the genesis file.")])]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If you've submitted staking or registry transactions before, your nonce is\nlikely different than the nonce used in the examples. If you're uncertain,\nplease check your account nonce by using "),s("router-link",{attrs:{to:"/operators/maintenance/checking-account-nonce.html"}},[e._v("this\nguide")])],1)]),e._v(" "),s("p",[e._v("Once you have been funded, you can now complete the process of connecting your\nnode by staking so that you can register your entity and register your node.")]),e._v(" "),s("h3",{attrs:{id:"check-that-your-node-is-synced"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-that-your-node-is-synced"}},[e._v("#")]),e._v(" Check that your node is synced")]),e._v(" "),s("p",[e._v("Before you can make any transactions you'll have to make sure that node is\nsynced. To do so call this command on the server:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node control is-synced "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -a unix:/serverdir/node/internal.sock "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"You are synced"')]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("||")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"You are not synced"')]),e._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("oasis-node control is-synced")]),e._v(" command has no output but returns an exit\ncode. The code above adds some sugar to make it a little easier to understand\ndue to the lack of output.")])]),e._v(" "),s("p",[e._v("If you're not synced, you will need to wait until your node has synced before\nyou can move forward.")]),e._v(" "),s("h3",{attrs:{id:"generating-a-staking-escrow-transaction-on-the-localhost"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generating-a-staking-escrow-transaction-on-the-localhost"}},[e._v("#")]),e._v(" Generating a Staking (Escrow) Transaction on the "),s("code",[e._v("localhost")])]),e._v(" "),s("p",[e._v("Your Entity private key should ideally be disconnected from the internet on the\n"),s("code",[e._v("localhost")]),e._v(". You want this because the Entity private key is used to authorize\ntransactions on your staking account. To ensure that the Entity private key\nisn't sent to the "),s("code",[e._v("server")]),e._v(" we will generate a transaction on the "),s("code",[e._v("localhost")]),e._v('.\nThe staking application calls "staking" an escrow. For the testnet, the current\nminimum stake required to register an entity and register a node as a validator\nis 100 tokens. So we will generate an escrow transaction that escrows 100 tokens\non your own Entity.')]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node stake account gen_escrow "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --genesis.file "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$GENESIS_FILE_PATH")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --entity "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$ENTITY_DIR_PATH")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --stake.escrow.account "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$ACCOUNT_ID")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --stake.amount "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100000000000000000000")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.file "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$OUTPUT_TX_FILE_PATH")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.fee.gas "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.fee.amount "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.nonce "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n")])])]),s("p",[e._v("The parameters are as follows:")]),e._v(" "),s("ul",[s("li",[s("p",[s("code",[e._v("$ENTITY_DIR_PATH")]),e._v(" - For this guide this would be "),s("code",[e._v("/localhostdir/entity/")])])]),e._v(" "),s("li",[s("p",[s("code",[e._v("$OUTPUT_TX_FILE_PATH")]),e._v(" - This is where you wish to output the signed\ntransaction file. For this guide we will use "),s("code",[e._v("/localhostdir/signed-escrow.tx")])])]),e._v(" "),s("li",[s("p",[s("code",[e._v("$ACCOUNT_ID")]),e._v(" - This is the hex encoding of the Entity Public Key. To derive\nthis you can use the following python3 code:")]),e._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" binascii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" base64\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("def")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("account_id_from_b64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("base64_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[e._v('"""base64_id can be found in entity.json in the `id` field"""')]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" binascii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("hexlify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("base64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("b64decode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("base64_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\naccount_id_from_b64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<YOUR ENTITY PUBLIC KEY>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"deadbeefdeadbeefdeadbeef..."')]),e._v("\n")])])])])]),e._v(" "),s("p",[e._v("Note that the option "),s("code",[e._v("--stake.transaction.amount")]),e._v(" looks like a very large\nnumber. This is actually equivalent to 100 tokens on the Testnet as each unit\nvalue used to track the account balance is 1x10^-18 tokens.")]),e._v(" "),s("h3",{attrs:{id:"generating-entity-registration-transaction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generating-entity-registration-transaction"}},[e._v("#")]),e._v(" Generating Entity Registration Transaction")]),e._v(" "),s("p",[e._v("After you submit your escrow account, you'll need to register your entity so\nthat your node registers properly. You could do this process "),s("em",[e._v("after")]),e._v(" you\nsubmit the escrow transaction, however, to save steps we prepare everything\nbefore hand.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node registry entity gen_register "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --genesis.file "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$GENESIS_FILE_PATH")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --entity "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$ENTITY_DIR_PATH")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.file "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$OUTPUT_REGISTER_TX_FILE_PATH")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.fee.gas "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.fee.amount "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.nonce "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n")])])]),s("ul",[s("li",[s("code",[e._v("$ENTITY_DIR_PATH")]),e._v(" - For this guide this would be "),s("code",[e._v("/localhostdir/entity/")])]),e._v(" "),s("li",[s("code",[e._v("$OUTPUT_REGISTER_TX_FILE_PATH")]),e._v(" - This is where you wish to output the signed\ntransaction file. For this guide we will use\n"),s("code",[e._v("/localhostdir/signed-register.tx")])])]),e._v(" "),s("h3",{attrs:{id:"submitting-your-transactions-on-the-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#submitting-your-transactions-on-the-server"}},[e._v("#")]),e._v(" Submitting Your Transactions on the "),s("code",[e._v("server")])]),e._v(" "),s("p",[e._v("To complete the staking process we need to submit your escrow and registry\ntransactions:")]),e._v(" "),s("ol",[s("li",[e._v("Copy the file "),s("code",[e._v("/localhostdir/signed-escrow.tx")]),e._v(" on the "),s("code",[e._v("localhost")]),e._v(" to\n"),s("code",[e._v("/serverdir/signed-escrow.tx")]),e._v(" on the "),s("code",[e._v("server")]),e._v(".")]),e._v(" "),s("li",[e._v("Copy the file "),s("code",[e._v("/localhostdir/signed-register.tx")]),e._v(" on the "),s("code",[e._v("localhost")]),e._v(" to\n"),s("code",[e._v("/serverdir/signed-register.tx")]),e._v(" on the "),s("code",[e._v("server")]),e._v(".")]),e._v(" "),s("li",[e._v("Call "),s("code",[e._v("oasis-node")]),e._v(" like so:")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("oasis-node consensus submit_tx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.file /serverdir/signed-escrow.tx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -a unix:/serverdir/node/internal.sock\noasis-node consensus submit_tx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --transaction.file /serverdir/signed-register.tx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -a unix:/serverdir/node/internal.sock\n")])])]),s("h3",{attrs:{id:"checking-that-your-node-is-properly-registered"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checking-that-your-node-is-properly-registered"}},[e._v("#")]),e._v(" Checking that Your Node is Properly Registered")]),e._v(" "),s("p",[s("em",[e._v("We understand these instructions for verification need to improve. Any\nassistance is welcome ðŸ˜‰")])]),e._v(" "),s("p",[e._v("To ensure that your node is properly connected as a Validator on the network, We\ncan check to see the node's identity on in the registry's node list.\nUnfortunately, at this time this is a bit of a manual process.")]),e._v(" "),s("h3",{attrs:{id:"getting-the-node-s-consensus-pub-pem-identity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-the-node-s-consensus-pub-pem-identity"}},[e._v("#")]),e._v(" Getting the Node's consensus_pub.pem Identity")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /serverdir/node/consensus_pub.pem\n")])])]),s("p",[e._v("This will look like:")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("-----BEGIN ED25519 PUBLIC KEY-----\ns+vZ71qeZnlq0HmQSDBiWn2OKcy3fXOuPMu76/5GkUI=\n-----END ED25519 PUBLIC KEY-----\n")])])]),s("p",[e._v("We will use "),s("code",[e._v("s+vZ71qeZnlq0HmQSDBiWn2OKcy3fXOuPMu76/5GkUI=")]),e._v(" as the key to search\nfor.")]),e._v(" "),s("h3",{attrs:{id:"grepping-for-the-node-s-identity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#grepping-for-the-node-s-identity"}},[e._v("#")]),e._v(" grepping for the Node's Identity")]),e._v(" "),s("p",[e._v("Finally to see if the node is properly registered, run the command:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("NODE_PUB_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s+vZ71qeZnlq0HmQSDBiWn2OKcy3fXOuPMu76/5GkUI="')]),e._v("\noasis-node registry node list -v -a unix:/serverdir/node/internal.sock "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$NODE_PUB_KEY")]),e._v("\n")])])]),s("p",[e._v("If "),s("code",[e._v("grep")]),e._v(" found the key, then you're properly connected!")]),e._v(" "),s("h2",{attrs:{id:"you-re-a-validator"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#you-re-a-validator"}},[e._v("#")]),e._v(" You're a Validator!")]),e._v(" "),s("p",[e._v("If you've made it this far you've properly connected your node to the network\nand you're now a Validator on the Public Testnet.")])])}),[],!1,null,null,null);t.default=a.exports}}]);