(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{353:function(t,s,a){"use strict";a.r(s);var e=a(33),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"stake-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stake-management"}},[t._v("#")]),t._v(" Stake Management")]),t._v(" "),a("p",[t._v("For node operators, the "),a("code",[t._v("oasis-node")]),t._v(" binary offers a command line interface for\nvarious staking token operations.")]),t._v(" "),a("p",[t._v("The following commands are intended to be run "),a("strong",[t._v("online")]),t._v(" (i.e. on the "),a("code",[t._v("server")]),t._v("):")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("oasis-node stake info")]),t._v(" shows the token information,")]),t._v(" "),a("li",[a("code",[t._v("oasis-node stake list")]),t._v(" lists all accounts with positive balance,")]),t._v(" "),a("li",[a("code",[t._v("oasis-node stake account info")]),t._v(" shows detailed account information,")]),t._v(" "),a("li",[a("code",[t._v("oasis-node consensus submit_tx")]),t._v(" submits a pre-generated transaction given a\nfilename.")])]),t._v(" "),a("p",[t._v("In addition, the following commands generate transactions and are meant to be\nrun offline (i.e. on the "),a("code",[t._v("localhost")]),t._v("), because signing transactions requires a\nprivate key which "),a("strong",[t._v("should not be accessible")]),t._v(" from outside in any way:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("oasis-node stake account gen_transfer")])]),t._v(" "),a("li",[a("code",[t._v("oasis-node stake account gen_burn")])]),t._v(" "),a("li",[a("code",[t._v("oasis-node stake account gen_escrow")])]),t._v(" "),a("li",[a("code",[t._v("oasis-node stake account gen_reclaim_escrow")])])]),t._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[t._v("#")]),t._v(" Prerequisites")]),t._v(" "),a("p",[t._v("We will assume you are familiar with the previous sections of the\n"),a("RouterLink",{attrs:{to:"/operators/overview.html"}},[t._v("Operator Docs")]),t._v(" and have the "),a("code",[t._v("oasis-node")]),t._v(" binary installed.")],1),t._v(" "),a("p",[t._v("To run a command that requires a connection to the online Oasis node (i.e. the\n"),a("code",[t._v("server")]),t._v("), you need to either:")]),t._v(" "),a("ul",[a("li",[t._v("change the working directory to where the internal Oasis node unix socket is\nlocated (e.g. "),a("code",[t._v("/serverdir/node/")]),t._v(") before executing the command, or")]),t._v(" "),a("li",[t._v("pass the "),a("code",[t._v("-a $ADDR")]),t._v(" flag where "),a("code",[t._v("ADDR")]),t._v(" represents the path to the internal\nOasis node unix socket prefixed with "),a("code",[t._v("unix:")]),t._v(" (e.g.\n"),a("code",[t._v("unix:/serverdir/node/internal.sock")]),t._v(").")])]),t._v(" "),a("p",[t._v("We will pipe the output of commands that return JSON through "),a("a",{attrs:{href:"https://docs.python.org/3/library/json.html#module-json.tool",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python's\n"),a("code",[t._v("json.tool")]),t._v(" module"),a("OutboundLink")],1),t._v(" to pretty-print it.")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Be aware that "),a("a",{attrs:{href:"http://stedolan.github.io/jq/",target:"_blank",rel:"noopener noreferrer"}},[t._v("jq"),a("OutboundLink")],1),t._v(", the popular JSON CLI tool, "),a("a",{attrs:{href:"https://github.com/stedolan/jq/wiki/FAQ#caveats",target:"_blank",rel:"noopener noreferrer"}},[t._v("converts all numbers to IEEE 754\n64-bit values"),a("OutboundLink")],1),t._v(" which can result in silent loss of precision and/or\nother changes.")]),t._v(" "),a("p",[t._v("Hence, we recommend avoiding its usage until this issue is resolved.")])]),t._v(" "),a("h2",{attrs:{id:"common-token-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#common-token-info"}},[t._v("#")]),t._v(" Common token info")]),t._v(" "),a("p",[t._v("To query an Oasis node for the common token info, run:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake info -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v("\n")])])]),a("p",[t._v("This will output something like:")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Total supply: 10000000000000000000\nCommon pool: 7999214452933172880\nStaking threshold (entity): 100000000000\nStaking threshold (validator node): 100000000000\nStaking threshold (compute node): 100000000000\nStaking threshold (storage node): 100000000000\nStaking threshold (key manager node): 100000000000\nStaking threshold (compute runtime): 100000000000\nStaking threshold (key manager runtime): 100000000000\n")])])]),a("p",[t._v("The numbers are listed in base units, 1 token corresponds to 10^9 (i.e. one\nbillion) base units.")]),t._v(" "),a("p",[t._v("We can observe that the total supply is 10 billion tokens and that almost 8\nbillion tokens are in the "),a("em",[t._v("common pool")]),t._v(".")]),t._v(" "),a("p",[t._v("Finally, the staking thresholds for all node kinds (entity, validator, compute,\nstorage) and runtime kinds (compute, key manager) are 100 tokens.")]),t._v(" "),a("h2",{attrs:{id:"account-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#account-info"}},[t._v("#")]),t._v(" Account info")]),t._v(" "),a("p",[t._v("To list all accounts with positive balance, run:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake list -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v("\n")])])]),a("p",[t._v("This will list all accounts' IDs, e.g.:")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\nA1X90rT/WK4AOTh/dJsUlOqNDV/nXM6ZU+h+blS9pto=\nBEcj10gSGUnJULd08jWfbYaMMrqT2rCnxCVrvJdgdiQ=\nBNrK/6GsNTrYT/4qk7pnI6NI/gYV3t+b3KT4bixYMcY=\nCVzqFIADD2Ed0khGBNf4Rvh7vSNtrL1ULTkWYQszDpc=\nCk7Z5SGgciwGD7VsPIUOejIinePljhA9DLFCE954L0g=\nCne+0Jngok/d7CEw4ho7iUK+Q729s2LSPbLtqN2PZNs=\nCyw0yR8PhT7zeekbNE+C38VWHqScS6SRCGCMHLts+zM=\nC5z1jB+FHB/QgtTITr6NKWpUs9QHwD11CG3v8tmuJ0g=\nDFYChJMceD8nNp6ueVUCNEpqGROg7zS7AImn74c9s6s=\nDMLG+Ta/ycWQmYTIwA3kCUyXHUBwwhjvHThNTsHLyYo=\nDPbZomOIleFrvcJBZPl7y/wEB1w9Q569vAbb6Krl9fE=\nDPeFA5/JMSGw+kp2o3bJ2yNq5AUMkiQop+bFP5vc82M=\nDVobZ8bWlOv2J6oHO0uITr5FPO5rIY2irdPNhByprHk=\nDoVToHyHxlHdyt4Kp//R34xisSULeIKaWNofvVEkEPM=\nD2hqhJcmZnBmhw9TodOdoFPAjmRkpRatANCNHxIDHgA=\nEg+MQjy5m+RbI9ASaXvhX2WrdIJ949I1XIwyEQU/gc4=\nFATFD8gST26YTWtJ4gJnWS1xoKPw7/nQm8bBtm2aedA=\n\n... output trimmed ...\n\n")])])]),a("p",[t._v("To get more information about a particular account, e.g.\n"),a("code",[t._v("+yyK5gqJb7x8xPASJZznZk8X8h0ilXuv39ctFYeHlCg=")]),t._v(", run:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account info "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.account.id +yyK5gqJb7x8xPASJZznZk8X8h0ilXuv39ctFYeHlCg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" python3 -m json.tool\n")])])]),a("p",[t._v("This will output all staking information about this particular account, e.g.:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"601492492765"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11242384816640"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10000000000000"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commission_schedule"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rates"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bounds"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stake_accumulator"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"claims"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.RegisterEntity"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.RegisterNode.GKdkhntFqH5b0mXtRR6Q8nz1vcsFDnLyWWuCtmVhwJs="')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("Account's general balance ("),a("code",[t._v("general.balance")]),t._v("), the amount of base units that\nare available to the account owner, is a little more than 601 tokens.")]),t._v(" "),a("li",[t._v("Account's nonce ("),a("code",[t._v("general.nonce")]),t._v(") is the incremental number that must be\nunique for each account's transaction. The next transaction should have nonce\nequal to "),a("code",[t._v("0")]),t._v(".")])]),t._v(" "),a("p",[t._v("Each account can also serve as an escrow account.\nEscrow accounts are used to keep the funds needed for specific consensus-layer\noperations (e.g. registering and running nodes).")]),t._v(" "),a("p",[t._v("To simplify accounting, each escrow results in the source account being issued\nshares which can be converted back into staking tokens during the reclaim escrow\noperation.\nReclaiming escrow does not complete immediately, but may be subject to a\ndebonding period during which the tokens still remain escrowed.")]),t._v(" "),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("The amount of tokens that are actively bounded to the escrow account (\n"),a("code",[t._v("escrow.active.balance")]),t._v(") is a little more than 11242 tokens.")]),t._v(" "),a("li",[t._v("The total number of shares for the tokens actively bounded to the escrow\naccount ("),a("code",[t._v("escrow.active.total_shares")]),t._v(") is 10 trillion.")]),t._v(" "),a("li",[t._v("The amount of tokens that are currently debonding ("),a("code",[t._v("escrow.debonding.balance")]),t._v(")\nis 0.")]),t._v(" "),a("li",[t._v("The total number of shares for the tokens that are currently debonding\n("),a("code",[t._v("escrow.debonding.total_shares")]),t._v(") is 0.")])]),t._v(" "),a("p",[t._v("An entity can also charge commission for tokens that are delegated to it.\nThe commission schedule rate steps would be defined in\n"),a("code",[t._v("escrow.commission_schedule.rates")]),t._v(" and the commission rate bound steps would be\ndefined in "),a("code",[t._v("escrow.commission_schedule.bounds")]),t._v(".")]),t._v(" "),a("p",[t._v("Each escrow account also has a corresponding stake accumulator.\nIt stores stake claims for an escrow account and ensures all claims are\nsatisfied at any given point.\nAdding a new claim is only possible if all of the existing claims plus the new\nclaim can be satisfied.")]),t._v(" "),a("p",[t._v("We can observe that the stake accumulator currently has two claims:")]),t._v(" "),a("ul",[a("li",[t._v("The first one is for registering an entity. The value it maps to is a list of\nstaking threshold kinds.\n"),a("code",[t._v("0")]),t._v(" represents the threshold for registering an entity.")]),t._v(" "),a("li",[t._v("The second one is for registering a node with ID\n"),a("code",[t._v("GKdkhntFqH5b0mXtRR6Q8nz1vcsFDnLyWWuCtmVhwJs=")]),t._v(". The value it maps to is again\na list of staking threshold kinds.\n"),a("code",[t._v("1")]),t._v(" represents the threshold for registering a validator node.")])]),t._v(" "),a("h2",{attrs:{id:"generating-and-submitting-transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generating-and-submitting-transactions"}},[t._v("#")]),t._v(" Generating and submitting transactions")]),t._v(" "),a("p",[t._v("Next, we will learn how to generate and sign transactions offline (i.e. on the\n"),a("code",[t._v("localhost")]),t._v(") and then submit them on the online Oasis node (i.e. the "),a("code",[t._v("server")]),t._v(").")]),t._v(" "),a("h3",{attrs:{id:"base-flags"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#base-flags"}},[t._v("#")]),t._v(" Base flags")]),t._v(" "),a("p",[t._v("All commands for generating and signing transactions need the following base\nflags set:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("--genesis.file")]),t._v(": Path to the genesis file on the "),a("code",[t._v("localhost")]),t._v(", e.g.\n"),a("code",[t._v("/localhostdir/genesis.json")]),t._v(".")])]),t._v(" "),a("h3",{attrs:{id:"signer-flags"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signer-flags"}},[t._v("#")]),t._v(" Signer flags")]),t._v(" "),a("p",[t._v("Currently, we provide two options for signing transactions:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Ledger device.")]),t._v(" "),a("p",[t._v("You will need to set it up as described in our "),a("RouterLink",{attrs:{to:"/hsm/ledger.html"}},[t._v("Ledger docs")]),t._v(" and set the\nfollowing flags:")],1),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("--signer ledger")]),t._v(": Specifies use of the Ledger signer.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--signer.ledger.address")]),t._v(": The "),a("code",[t._v("Oasis App Address")]),t._v(" that identifies the\nLedger device you want to use for signing.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("You can omit this flag and "),a("code",[t._v("oasis-node")]),t._v(" will try to connect to any available\nLedger device.")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--signer.ledger.index")]),t._v(": Address index used to derive address\naddress on the Ledger device.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--signer.dir")]),t._v(": Path to entity's artifacts directory on the "),a("code",[t._v("localhost")]),t._v(",\ne.g. "),a("code",[t._v("/localhostdir/entity/")]),t._v(".")])])])]),t._v(" "),a("li",[a("p",[t._v("Entity's private key stored in a file.")]),t._v(" "),a("p",[t._v("You will need to create your Entity as described in "),a("RouterLink",{attrs:{to:"/operators/joining-the-testnet.html#creating-your-entity"}},[t._v("Joining the Testnet")]),t._v(" docs and set the following flags:")],1),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("--signer file")]),t._v(": Specifies use of the file signer.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("Currently, "),a("code",[t._v("file")]),t._v(" is the default signer so you could also omit this flag.")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--signer.dir")]),t._v(": Path to entity's artifacts directory on the "),a("code",[t._v("localhost")]),t._v(",\ne.g. "),a("code",[t._v("/localhostdir/entity/")]),t._v(".")])])])])]),t._v(" "),a("h3",{attrs:{id:"storing-base-and-signer-flags-in-an-environment-variable"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#storing-base-and-signer-flags-in-an-environment-variable"}},[t._v("#")]),t._v(" Storing Base and Signer flags in an environment variable")]),t._v(" "),a("p",[t._v("To make the transaction commands shorter and avoid typing errors, one can set an\nenvironment variable, e.g. "),a("code",[t._v("TX_FLAGS")]),t._v(", with all the "),a("a",{attrs:{href:"#base-flags"}},[t._v("Base flags")]),t._v(" and\n"),a("a",{attrs:{href:"#signer-flags"}},[t._v("Signer flags")]),t._v(" configured for his particular set up.")]),t._v(" "),a("p",[t._v("For example, one could set "),a("code",[t._v("TX_FLAGS")]),t._v(" for a Ledger device like below (replacing\nLedger device address and address index appropriately):")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TX_FLAGS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--genesis.file /localhostdir/genesis.json \\\n  --signer ledger \\\n  --signer.ledger.address oasis19hpt4y2reqwyfqcd53asjchdqf468chr673y6jn07xjp36w32jlscf0me \\\n  --signer.ledger.index 1 \\\n  --signer.dir /localhostdir/entity/"')]),t._v("\n")])])]),a("p",[t._v("Or, one could set "),a("code",[t._v("TX_FLAGS")]),t._v(" like below to use a file signer:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TX_FLAGS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--genesis.file /localhostdir/genesis.json \\\n  --signer file \\\n  --signer.dir /localhostdir/entity/"')]),t._v("\n")])])]),a("h3",{attrs:{id:"common-transaction-flags"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#common-transaction-flags"}},[t._v("#")]),t._v(" Common transaction flags")]),t._v(" "),a("p",[t._v("When generating a transaction, one needs to set the following transaction flags\nas appropriate for a given transaction:")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("--stake.amount")]),t._v(": Amount of base units to transfer, escrow, burn, etc.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--transaction.file")]),t._v(": Path to the file where to store the generated\ntransaction.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--transaction.nonce")]),t._v(": Incremental number that must be unique for each\naccount's transaction.")]),t._v(" "),a("p",[t._v("To get your current account's nonce, see "),a("RouterLink",{attrs:{to:"/operators/maintenance/checking-account-nonce.html"}},[t._v("Checking Your Account nonce")]),t._v(" doc.")],1)]),t._v(" "),a("li",[a("p",[a("code",[t._v("--transaction.fee.gas")]),t._v(": Maximum amount of gas (in "),a("em",[t._v("gas units")]),t._v(") a transaction\ncan spend.")]),t._v(" "),a("p",[t._v("Gas costs for different staking transactions are specified by the\n"),a("code",[t._v("staking.params.gas_costs")]),t._v(" consensus parameter.")]),t._v(" "),a("p",[t._v("To obtain its value from the genesis file, run:\n")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /localhostdir/genesis.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  python3 -c "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'import sys, json; print(json.dumps(json.load(sys.stdin)["staking"]["params"]["gas_costs"], indent=4))\'')]),t._v("\n")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("Currently, gas costs for transactions are set in the genesis file and cannot\nbe changed. If updating consensus parameters is supported (tracked by\n"),a("a",{attrs:{href:"https://github.com/oasislabs/oasis-core/issues/2334",target:"_blank",rel:"noopener noreferrer"}},[t._v("Oasis Core #2334"),a("OutboundLink")],1),t._v("), this will no longer be the case.")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("--transaction.fee.amount")]),t._v(": Amount of base units we will pay as a fee for a\ntransaction.")])])]),t._v(" "),a("p",[t._v("Note that specifying a transaction's fee amount (via "),a("code",[t._v("--transaction.fee.amount")]),t._v(")\nand maximum gas amount (via "),a("code",[t._v("--transaction.fee.gas")]),t._v(") implicitly defines the\n"),a("em",[t._v("gas price")]),t._v(" (in base units):")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("gas_price = fee_amount / gas_amount\n")])])]),a("p",[t._v("Gas price tells how much base units we are willing to pay for one gas unit.")]),t._v(" "),a("p",[t._v("Consensus validators can configure their own "),a("em",[t._v("minimum gas price")]),t._v(" (via\n"),a("code",[t._v("consensus.tendermint.min_gas_price")]),t._v(" configuration flag) and will refuse to\nprocess transactions that have their gas price set below their minimum gas\nprice.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("Currently, there is no mechanism to discover what minimum gas prices are used by\nvalidators.")]),t._v(" "),a("p",[t._v("For more details, see "),a("a",{attrs:{href:"https://github.com/oasislabs/oasis-core/issues/2526",target:"_blank",rel:"noopener noreferrer"}},[t._v("Oasis Core #2526"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("h2",{attrs:{id:"example-transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-transactions"}},[t._v("#")]),t._v(" Example transactions")]),t._v(" "),a("p",[t._v("Let's assume our entity's account is\n"),a("code",[t._v("+yyK5gqJb7x8xPASJZznZk8X8h0ilXuv39ctFYeHlCg=")]),t._v(" (the same that we queried for\ninfo in the "),a("a",{attrs:{href:"#account-info"}},[t._v("Account info")]),t._v(" section) and generate some concrete transactions for\nit.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("If you want to follow these examples yourself, make sure you've set the\n"),a("code",[t._v("TX_FLAGS")]),t._v(" environment variable as described in the "),a("a",{attrs:{href:"#storing-base-and-signer-flags-in-an-environment-variable"}},[t._v("Storing Base and Signer\nflags in an environment variable")]),t._v(" section.")])]),t._v(" "),a("h3",{attrs:{id:"querying-account-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#querying-account-info"}},[t._v("#")]),t._v(" Querying account info")]),t._v(" "),a("p",[t._v("To query our entity's account info, use the following command:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account info "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.account.id +yyK5gqJb7x8xPASJZznZk8X8h0ilXuv39ctFYeHlCg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" python3 -m json.tool\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("For a detailed explanation on querying account information, see "),a("a",{attrs:{href:"#account-info"}},[t._v("Account info")]),t._v("\nsection.")])]),t._v(" "),a("p",[t._v("At the beginning, this outputs:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"601492492765"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11242384816640"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10000000000000"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("Account's general balance is a little more than 601 tokens.")]),t._v(" "),a("li",[t._v("Account's nonce is "),a("code",[t._v("0")]),t._v(".")]),t._v(" "),a("li",[t._v("A little more than 11242 tokens are actively bounded to the escrow account.")]),t._v(" "),a("li",[t._v("The amount of tokens that are currently debonding is 0.")])]),t._v(" "),a("h3",{attrs:{id:"obtaining-transactions-gas-costs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#obtaining-transactions-gas-costs"}},[t._v("#")]),t._v(" Obtaining transactions' gas costs")]),t._v(" "),a("p",[t._v("As explained in the "),a("a",{attrs:{href:"#common-transaction-flags"}},[t._v("Common transaction flags")]),t._v(" section, we can obtain gas costs\nfor different staking transactions from the genesis file by running:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /localhostdir/genesis.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  python3 -c "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'import sys, json; print(json.dumps(json.load(sys.stdin)["staking"]["params"]["gas_costs"], indent=4))\'')]),t._v("\n")])])]),t._v(" "),a("p",[t._v("For our network, this returns:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"add_escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"burn"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reclaim_escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transfer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Hence, we will need to set the "),a("code",[t._v("--transaction.fee.gas")]),t._v(" flag, i.e. the maximum\namount of gas a transaction can spend, in the following transactions to at least\n1000 "),a("em",[t._v("gas units")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"burning-tokens"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#burning-tokens"}},[t._v("#")]),t._v(" Burning tokens")]),t._v(" "),a("p",[t._v("Let's start with a "),a("em",[t._v("burn")]),t._v(" transaction which destroys the given number of tokens.")]),t._v(" "),a("p",[t._v("To generate a burn transaction of 123 tokens (i.e. 123 * 10^9 base units)\nand sign it, run:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account gen_burn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TX_FLAGS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123000000000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_burn.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.nonce "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.gas "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v("\n")])])]),a("p",[t._v("To submit the generated transaction, we need to copy "),a("code",[t._v("tx_burn.json")]),t._v(" to the\nonline Oasis node (i.e. the "),a("code",[t._v("server")]),t._v(") and submit it from there:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node consensus submit_tx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_burn.json\n")])])]),a("p",[t._v("Let's "),a("a",{attrs:{href:"#querying-account-info"}},[t._v("check our account's info")]),t._v(" again:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"478492490765"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11242384816640"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10000000000000"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("Our account's general balance has decreased for 123 tokens and 2000 base\nunits. The latter corresponds to the fee that we specified we will pay for\nthis transaction.")]),t._v(" "),a("li",[t._v("Our account's nonce increased to "),a("code",[t._v("1")]),t._v(".")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Usually, the new balance is seen immediately, but some transactions (for example\nescrow reclaiming) do not take effect until after a debonding period has elapsed,\nso you might need to wait a few blocks for the balances to update.")])]),t._v(" "),a("h3",{attrs:{id:"transferring-tokens"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#transferring-tokens"}},[t._v("#")]),t._v(" Transferring tokens")]),t._v(" "),a("p",[t._v("Token transfer transactions transfer tokens from the signer's account to the\ngiven destination account.")]),t._v(" "),a("p",[t._v("Let's choose a destination account, e.g.\n"),a("code",[t._v("A1X90rT/WK4AOTh/dJsUlOqNDV/nXM6ZU+h+blS9pto=")]),t._v(", and "),a("a",{attrs:{href:"#querying-account-info"}},[t._v("check its current balance")]),t._v(" (replacing our entity's ID with the destination\naccount's ID):")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1030")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that the chosen destination account currently has general balance\nof 0 tokens.")]),t._v(" "),a("p",[t._v("Let's generate a transfer transaction of 170 tokens, (i.e. 170 * 10^9 base\nunits), from our account to the chosen destination account:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account gen_transfer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TX_FLAGS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("170000000000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.transfer.destination A1X90rT/WK4AOTh/dJsUlOqNDV/nXM6ZU+h+blS9pto"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_transfer.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.nonce "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.gas "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v("\n")])])]),a("p",[t._v("To submit the generated transaction, we need to copy "),a("code",[t._v("tx_transfer.json")]),t._v(" to the\nonline Oasis node (i.e. the "),a("code",[t._v("server")]),t._v(") and submit it from there:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node consensus submit_tx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_transfer.json\n")])])]),a("p",[t._v("Let's "),a("a",{attrs:{href:"#querying-account-info"}},[t._v("check both accounts' info")]),t._v(" (first ours and then\nthe destination's):")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"308492488765"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11242384816640"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10000000000000"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"170000000000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1030")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("Our general balance decreased for 170 tokens and 2000 base units. The latter\ncorresponds to the fee that we specified we will pay for this transaction.")]),t._v(" "),a("li",[t._v("Our account's nonce increased to "),a("code",[t._v("2")]),t._v(".")]),t._v(" "),a("li",[t._v("Destination account's general balance increased for 170 tokens.")])]),t._v(" "),a("h3",{attrs:{id:"escrowing-tokens"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#escrowing-tokens"}},[t._v("#")]),t._v(" Escrowing tokens")]),t._v(" "),a("p",[t._v("In this example we will put 208 tokens (i.e. 208 * 10^9 base units) to our own\nescrow account.")]),t._v(" "),a("p",[t._v("First, let's generate an escrow transaction and store it to "),a("code",[t._v("tx_escrow.json")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account gen_escrow "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TX_FLAGS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("208000000000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.escrow.account +yyK5gqJb7x8xPASJZznZk8X8h0ilXuv39ctFYeHlCg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_escrow.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.nonce "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.gas "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v("\n")])])]),a("p",[t._v("To submit the generated transaction, we need to copy "),a("code",[t._v("tx_escrow.json")]),t._v(" to the\nonline Oasis node (i.e. the "),a("code",[t._v("server")]),t._v(") and submit it from there:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node consensus submit_tx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_escrow.json\n")])])]),a("p",[t._v("Let's "),a("a",{attrs:{href:"#querying-account-info"}},[t._v("check our account's info")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100492486765"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11450384816640"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10185014125910"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("Our general balance decreased for 208 tokens and 2000 base units. The latter\ncorresponds to the fee that we specified we will pay for this transaction.")]),t._v(" "),a("li",[t._v("Our account's nonce increased to "),a("code",[t._v("3")]),t._v(".")]),t._v(" "),a("li",[t._v("Our escrow account's active balance increased for 208 tokens.")]),t._v(" "),a("li",[t._v("The total number of shares in our escrow account's active balance\nincreased from 10000000000000 to 10185014125910.")])]),t._v(" "),a("p",[t._v("When a delegator delegates some amount of tokens to an entity's account,\nthe delegator receives the number of shares proportional to the current\n"),a("em",[t._v("share price")]),t._v(" (in base units) calculated from the total number of base units\ndelegated to an entity's account so far and the number of shares issued so far:")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("shares_per_base_unit = entity_issued_shares / entity_delegated_base_units\n")])])]),a("p",[t._v("In our case, the current share price (i.e. "),a("code",[t._v("shares_per_base_unit")]),t._v(") is\n10000000000000 / 11242384816640 which is 0.8894909899542729.")]),t._v(" "),a("p",[t._v("For 208 tokens, the amount of newly issued shares is thus 208 * 10^9 *\n0.8894909899542729 which is 185014125910.48877 (rounded to 185014125910).")]),t._v(" "),a("h3",{attrs:{id:"reclaiming-escrowed-tokens"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reclaiming-escrowed-tokens"}},[t._v("#")]),t._v(" Reclaiming escrowed tokens")]),t._v(" "),a("p",[t._v("When we want to reclaim escrowed tokens, we can't do that directly. Instead, we\nneed to specify the number of shares we want to reclaim from an escrow account.")]),t._v(" "),a("p",[t._v("For example, to reclaim 357 billion shares from an escrow account, we need to\ngenerate the following reclaim escrow transaction:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account gen_reclaim_escrow "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TX_FLAGS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.shares "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("357000000000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.escrow.account +yyK5gqJb7x8xPASJZznZk8X8h0ilXuv39ctFYeHlCg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_reclaim.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.nonce "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.gas "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v("\n")])])]),a("p",[t._v("To submit the generated transaction, we need to copy "),a("code",[t._v("tx_reclaim.json")]),t._v(" to the\nonline Oasis node (i.e. the "),a("code",[t._v("server")]),t._v(") and submit it from there:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node consensus submit_tx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_reclaim.json\n")])])]),a("p",[t._v("Let's "),a("a",{attrs:{href:"#querying-account-info"}},[t._v("check our account's info")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100492484765"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11049031678686"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9828014125910"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debonding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"balance"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"401353137954"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_shares"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"401353137954"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("We can observe that:")]),t._v(" "),a("ul",[a("li",[t._v("Our general balance decreased for 2000 base units. This corresponds to the fee\nthat we specified we will pay for this transaction.")]),t._v(" "),a("li",[t._v("Our account's nonce increased to "),a("code",[t._v("4")]),t._v(".")]),t._v(" "),a("li",[t._v("Our escrow account's active number of shares decreased for 357 billion shares\nto 9828014125910.")]),t._v(" "),a("li",[t._v("Our escrow account's active balance decreased for 401353137954 base units and\nis now 11049031678686 base units.")]),t._v(" "),a("li",[t._v("Our escrow account's debonding balance increased to 401353137954 base units\nand its number of shares to the same amount.")])]),t._v(" "),a("p",[t._v("When a delegator wants to reclaim a certain number of escrowed tokens, the\n"),a("em",[t._v("base unit price")]),t._v(" (in shares) must be calculated based on the entity's escrow\naccount's current active balance and the number of issued shares:")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("base_units_per_share = entity_delegated_base_units / entity_issued_shares\n")])])]),a("p",[t._v("In our case, the current base unit price (i.e. "),a("code",[t._v("base_units_per_share")]),t._v(") is\n11450384816640 / 10185014125910 which is 1.124238481664054 base unit per share.")]),t._v(" "),a("p",[t._v("For 357 billion shares, the amount of base units that will be reclaimed is thus\n357 * 10^9 * 1.124238481664054 which is 401353137954.06726 (rounded to\n401353137954).")]),t._v(" "),a("p",[t._v("Hence, the escrow account's active balance decreased for 401353137954 base units\nand the debonding balance increased for the same amount.")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("While the number of debonding shares currently equals the number of base units\nthat are currently subject to debonding and hence, the amount of tokens we can\nexcept to reclaim after debonding period is over is a little over 401 tokens,\nthere is no guarantee that this stays the same until the end of the debonding\nperiod since any slashing could change shares' price.")])]),t._v(" "),a("p",[t._v("The debonding period is specified by the "),a("code",[t._v("staking.params.debonding_interval")]),t._v("\nconsensus parameter and is represented as a number of epochs that need to pass.")]),t._v(" "),a("p",[t._v("To obtain its value from the genesis file, run:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /localhostdir/genesis.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  python3 -c "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'import sys, json; print(json.load(sys.stdin)["staking"]["params"]["debonding_interval"])\'')]),t._v("\n")])])]),t._v(" "),a("p",[t._v("For our example network, this returns:")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("10\n")])])]),a("p",[t._v("After the debonding period has passed, the network will automatically move our\nescrow account's active debonding balance into our escrow account's active\nbalance.")]),t._v(" "),a("h3",{attrs:{id:"amending-a-commission-schedule"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#amending-a-commission-schedule"}},[t._v("#")]),t._v(" Amending a commission schedule")]),t._v(" "),a("p",[t._v("We can configure our account to take a commission on staking rewards given to\nour node(s).\nThe commission rate must be within bounds, which we can also configure.")]),t._v(" "),a("p",[t._v("Let's generate a transaction to:")]),t._v(" "),a("ul",[a("li",[t._v("tell everyone that our bounds allow us to set any rate (0% - 100%), and")]),t._v(" "),a("li",[t._v("we'll take 50%.")])]),t._v(" "),a("p",[t._v("We're not allowed to change the commission bounds too close in near future, so\nwe'd have to make changes a number of epochs in the future.")]),t._v(" "),a("p",[t._v("In the example, we're setting the bounds to start on epoch 16.\nAn account's default bounds are 0% maximum, so we have to wait until our new\nbounds go into effect to raise our rate to 50%.\nBecause of that, we'll specify that our rate also starts on epoch 16.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node stake account gen_amend_commission_schedule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TX_FLAGS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.commission_schedule.bounds "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("/0/100000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --stake.commission_schedule.rates "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("/50000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_amend_commission_schedule.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.nonce "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.gas "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.amount "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v("\n")])])]),a("p",[t._v("Rates and minimum/maximum rates are in units of 1/100,000, so "),a("code",[t._v("0")]),t._v(", "),a("code",[t._v("50000")]),t._v(", and\n"),a("code",[t._v("100000")]),t._v(" come out to 0%, 50%, and 100%, respectively.")]),t._v(" "),a("p",[t._v("To submit the generated transaction, we need to copy\n"),a("code",[t._v("tx_amend_commission_schedule.json")]),t._v(" to the online Oasis node (i.e. the "),a("code",[t._v("server")]),t._v(")\nand submit it from there:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("oasis-node consensus submit_tx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ADDR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file tx_amend_commission_schedule.json\n")])])]),a("p",[t._v("After that, we can "),a("a",{attrs:{href:"#querying-account-info"}},[t._v("check our account's info")]),t._v(", and we should see something like\nthis:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"general"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ...\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nonce"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"escrow"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ...\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commission_schedule"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rates"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rate"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"50000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bounds"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rate_min"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rate_max"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100000"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Node operators collect commissions when their node earns a staking reward for\ndelegators.\nA validator node earns a staking reward for participating in the consensus\nprotocol each epoch.\nThe commission rate is a fraction of the staking reward.")]),t._v(" "),a("p",[t._v("For example, if our node earns a reward of 0.007 tokens, 0.0035 tokens are added\nto the escrow pool (increasing the value of our escrow pool shares uniformly),\nand 0.0035 tokens are given to us (issuing us new shares as if we manually\ndeposited them).")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("To troubleshoot an amendment that's rejected, consult our "),a("a",{attrs:{href:"https://github.com/oasislabs/oasis-core/blob/0dee03d75b3e8cfb36293fbf8ecaaec6f45dd3a5/go/staking/api/commission_test.go#L61-L610",target:"_blank",rel:"noopener noreferrer"}},[t._v("compendium of 23\ncommon ways for a commission schedule amendment to fail"),a("OutboundLink")],1),t._v(".")])])])}),[],!1,null,null,null);s.default=n.exports}}]);