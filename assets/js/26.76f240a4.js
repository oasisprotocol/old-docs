(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{224:function(t,e,s){"use strict";s.r(e);var a=s(28),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"adding-or-removing-nodes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-or-removing-nodes"}},[t._v("#")]),t._v(" Adding or Removing Nodes")]),t._v(" "),s("p",[t._v("At some point you may wish to add or remove nodes from your entity. In order to\ndo so, you will need to have at least the following:")]),t._v(" "),s("ul",[s("li",[t._v("Access to a synced node")]),t._v(" "),s("li",[t._v("Access to your entity's private key")])]),t._v(" "),s("h2",{attrs:{id:"overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),s("p",[t._v("The process for adding/removing nodes is similar and has the following steps:")]),t._v(" "),s("ol",[s("li",[t._v("Retrieve your up to date entity descriptor ("),s("code",[t._v("entity.json")]),t._v(")")]),t._v(" "),s("li",[t._v("Update your entity descriptor by adding/removing a node")]),t._v(" "),s("li",[t._v("Generate a "),s("code",[t._v("register")]),t._v(" transaction to update your entity registration on the\nnetwork.")])]),t._v(" "),s("h2",{attrs:{id:"retrieving-your-latest-entity-descriptor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retrieving-your-latest-entity-descriptor"}},[t._v("#")]),t._v(" Retrieving Your Latest Entity Descriptor")]),t._v(" "),s("p",[t._v("To ensure that we do not update your entity descriptor ("),s("code",[t._v("entity.json")]),t._v(")\nincorrectly we should get the latest entity descriptor state. For this\noperation, you will need to know your the base64 encoding of your entity's\npublic key.")]),t._v(" "),s("p",[t._v("On your server run this command:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ENTITY_PUBLIC_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some-base64-public-key"')]),t._v("\noasis-node registry entity list "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -a unix:/serverdir/node/internal.sock -v "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ENTITY_PUBLIC_KEY")]),t._v("\n")])])]),s("h2",{attrs:{id:"updating-your-entity-descriptor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#updating-your-entity-descriptor"}},[t._v("#")]),t._v(" Updating Your Entity Descriptor")]),t._v(" "),s("h3",{attrs:{id:"to-add-a-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#to-add-a-node"}},[t._v("#")]),t._v(" To Add a Node")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),s("p",[t._v("Due to how the node election process works, only a single node from your entity\ncan be selected as a validator for any given epoch. Additional nodes will "),s("em",[t._v("not")]),t._v("\ngive you more voting power nor will it, inherently, provide high availability to\nhave multiple nodes.")])]),t._v(" "),s("p",[t._v("Adding a node is a simple operation that is directly supported by the\n"),s("code",[t._v("oasis-node")]),t._v(" binary. For this operation you'll need to have initialized a new\nnode, and you'll need to have the "),s("code",[t._v("node_genesis.json")]),t._v(" file in order to add it to\nthe entity descriptor.")]),t._v(" "),s("p",[t._v("Assuming that the "),s("code",[t._v("node_genesis.json")]),t._v(" is at\n"),s("code",[t._v("/localhostdir/new_node/node_genesis.json")]),t._v(" the command is the following:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NEW_NODE_GENESIS_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/localhostdir/new_node/node_genesis.json\noasis-node registry entity update "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --signer.dir /localhostdir/entity "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --entity.node.descriptor /localhostdir/new_node/node_genesis.json\n")])])]),s("h2",{attrs:{id:"to-remove-a-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#to-remove-a-node"}},[t._v("#")]),t._v(" To Remove a Node")]),t._v(" "),s("p",[t._v("Removing a node requires updating the entity descriptor manually. The\nentity descriptor file is a simple JSON document that looks something like:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nodes"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB="')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"allow_entity_signed_nodes"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("In the above entity descriptor 2 nodes are attached to the entity:")]),t._v(" "),s("ol",[s("li",[t._v("A node with an identity "),s("code",[t._v("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=")])]),t._v(" "),s("li",[t._v("A node with an identity "),s("code",[t._v("BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=")])])]),t._v(" "),s("p",[t._v("To remove the the Node "),s("code",[t._v("BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=")]),t._v(" you would\nremove it from the array in the "),s("code",[t._v("nodes")]),t._v(" field, like so:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nodes"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"allow_entity_signed_nodes"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"updating-your-entity-registration-on-the-network"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#updating-your-entity-registration-on-the-network"}},[t._v("#")]),t._v(" Updating Your Entity Registration on the Network")]),t._v(" "),s("p",[t._v("Finally, to commit the changes on the network you'll need to generate a\n"),s("code",[t._v("register")]),t._v(" transaction and submit that transaction to the network.")]),t._v(" "),s("h3",{attrs:{id:"generating-a-register-transaction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generating-a-register-transaction"}},[t._v("#")]),t._v(" Generating a "),s("code",[t._v("register")]),t._v(" Transaction")]),t._v(" "),s("p",[t._v("Run this command on your localhost (as you need your entity's private key):")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GENESIS_FILE_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path/to/the/current/genesis"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OUTPUT_REGISTER_TX_FILE_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/localhostdir/update_entity_registration.tx"')]),t._v("\noasis-node registry entity gen_register "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --genesis.file "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GENESIS_FILE_PATH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --signer "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --signer.dir "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ENTITY_DIR_PATH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$OUTPUT_REGISTER_TX_FILE_PATH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.gas "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.fee.amount "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.nonce "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),s("p",[t._v("Once this has exited with a "),s("code",[t._v("0")]),t._v(" status, you should have a file at\n"),s("code",[t._v("$OUTPUT_REGISTER_TX_FILE_PATH")]),t._v(". Upload that file to your server.")]),t._v(" "),s("h3",{attrs:{id:"submitting-the-transaction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#submitting-the-transaction"}},[t._v("#")]),t._v(" Submitting the Transaction")]),t._v(" "),s("p",[t._v("Run this command on your server:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("oasis-node consensus submit_tx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --transaction.file /serverdir/update_entity_registration.tx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -a unix:/serverdir/node/internal.sock\n")])])]),s("p",[t._v("If there are no errors, your entity registration should be updated. You can run\nthis command to see the changes reflected:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ENTITY_PUBLIC_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some-base64-public-key"')]),t._v("\noasis-node registry entity list "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -a unix:/serverdir/node/internal.sock -v "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ENTITY_PUBLIC_KEY")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);